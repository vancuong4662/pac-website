# K·∫ø ho·∫°ch ph√°t tri·ªÉn h·ªá th·ªëng gi·ªè h√†ng v√† b√°n s·∫£n ph·∫©m

## T·ªïng quan h·ªá th·ªëng

Website s·∫Ω c√≥ 2 lo·∫°i s·∫£n ph·∫©m ch√≠nh:
1. **Kh√≥a h·ªçc**: S·∫£n ph·∫©m offline v·ªõi m√£ kh√≥a h·ªçc
2. **Gi·∫£i ph√°p**: Chia l√†m 2 lo·∫°i con
   - Tr·∫Øc nghi·ªám online (2 g√≥i)
   - T∆∞ v·∫•n offline v·ªõi chuy√™n gia (2 g√≥i)

## C·∫•u tr√∫c Database

### 1. B·∫£ng s·∫£n ph·∫©m (products)
```sql
CREATE TABLE products (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    price DECIMAL(10,2) NOT NULL,
    type ENUM('course', 'online_test', 'consultation') NOT NULL,
    package_type VARCHAR(50), -- 'basic', 'premium' cho gi·∫£i ph√°p
    status ENUM('active', 'inactive') DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### 2. B·∫£ng gi·ªè h√†ng (cart)
```sql
CREATE TABLE cart (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    product_id INT NOT NULL,
    quantity INT DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (product_id) REFERENCES products(id)
);
```

### 3. B·∫£ng ƒë∆°n h√†ng (orders)
```sql
CREATE TABLE orders (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    total_amount DECIMAL(10,2) NOT NULL,
    status ENUM('pending', 'completed', 'cancelled') DEFAULT 'pending',
    payment_method VARCHAR(50),
    payment_status ENUM('pending', 'paid', 'failed') DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

### 4. B·∫£ng chi ti·∫øt ƒë∆°n h√†ng (order_items)
```sql
CREATE TABLE order_items (
    id INT PRIMARY KEY AUTO_INCREMENT,
    order_id INT NOT NULL,
    product_id INT NOT NULL,
    quantity INT NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (order_id) REFERENCES orders(id),
    FOREIGN KEY (product_id) REFERENCES products(id)
);
```

### 5. B·∫£ng kh√≥a h·ªçc ƒë√£ mua (purchased_courses)
```sql
CREATE TABLE purchased_courses (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    order_id INT NOT NULL,
    product_id INT NOT NULL,
    course_code VARCHAR(50) UNIQUE NOT NULL, -- M√£ kh√≥a h·ªçc duy nh·∫•t
    status ENUM('active', 'used', 'expired') DEFAULT 'active',
    expires_at TIMESTAMP NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (order_id) REFERENCES orders(id),
    FOREIGN KEY (product_id) REFERENCES products(id)
);
```

### 6. B·∫£ng tr·∫Øc nghi·ªám ƒë√£ mua (purchased_tests)
```sql
CREATE TABLE purchased_tests (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    order_id INT NOT NULL,
    product_id INT NOT NULL,
    test_token VARCHAR(100) UNIQUE NOT NULL, -- Token ƒë·ªÉ truy c·∫≠p tr·∫Øc nghi·ªám
    attempts_left INT DEFAULT 1, -- S·ªë l·∫ßn l√†m b√†i c√≤n l·∫°i
    status ENUM('active', 'completed', 'expired') DEFAULT 'active',
    expires_at TIMESTAMP NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (order_id) REFERENCES orders(id),
    FOREIGN KEY (product_id) REFERENCES products(id)
);
```

### 7. B·∫£ng t∆∞ v·∫•n ƒë√£ ƒë·∫∑t (consultation_bookings)
```sql
CREATE TABLE consultation_bookings (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    order_id INT NOT NULL,
    product_id INT NOT NULL,
    consultation_code VARCHAR(50) UNIQUE NOT NULL,
    status ENUM('pending', 'scheduled', 'completed', 'cancelled') DEFAULT 'pending',
    scheduled_at TIMESTAMP NULL,
    expert_id INT NULL, -- ID c·ªßa chuy√™n gia ƒë∆∞·ª£c ph√¢n c√¥ng
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (order_id) REFERENCES orders(id),
    FOREIGN KEY (product_id) REFERENCES products(id)
);
```

### 8. B·∫£ng chuy√™n gia (experts)
```sql
CREATE TABLE experts (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    phone VARCHAR(20),
    specialty VARCHAR(255),
    status ENUM('active', 'inactive') DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## C·∫•u tr√∫c Frontend

### 1. Trang s·∫£n ph·∫©m
- `/products` - Danh s√°ch t·∫•t c·∫£ s·∫£n ph·∫©m
- `/products/courses` - Danh s√°ch kh√≥a h·ªçc
- `/products/solutions` - Danh s√°ch gi·∫£i ph√°p
- `/products/{id}` - Chi ti·∫øt s·∫£n ph·∫©m

### 2. Gi·ªè h√†ng
- `/cart` - Trang gi·ªè h√†ng
- Component: `cart-item.html`, `cart-summary.html`

### 3. Thanh to√°n
- `/checkout` - Trang thanh to√°n
- `/order-confirmation/{order_id}` - Trang x√°c nh·∫≠n ƒë∆°n h√†ng

### 4. Qu·∫£n l√Ω mua h√†ng
- `/my-purchases` - L·ªãch s·ª≠ mua h√†ng
- `/my-courses` - Kh√≥a h·ªçc ƒë√£ mua
- `/my-tests` - Tr·∫Øc nghi·ªám ƒë√£ mua
- `/my-consultations` - L·ªãch t∆∞ v·∫•n

### 5. Tr·∫Øc nghi·ªám
- `/test/{token}` - Trang l√†m tr·∫Øc nghi·ªám v·ªõi token

## C·∫•u tr√∫c Backend API

### 1. API S·∫£n ph·∫©m
- `GET /api/products` - L·∫•y danh s√°ch s·∫£n ph·∫©m
- `GET /api/products/{id}` - L·∫•y chi ti·∫øt s·∫£n ph·∫©m
- `POST /api/admin/products` - Th√™m s·∫£n ph·∫©m (Admin)
- `PUT /api/admin/products/{id}` - C·∫≠p nh·∫≠t s·∫£n ph·∫©m (Admin)
- `DELETE /api/admin/products/{id}` - X√≥a s·∫£n ph·∫©m (Admin)

### 2. API Gi·ªè h√†ng
- `GET /api/cart` - L·∫•y gi·ªè h√†ng hi·ªán t·∫°i
- `POST /api/cart/add` - Th√™m s·∫£n ph·∫©m v√†o gi·ªè
- `PUT /api/cart/update/{item_id}` - C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng
- `DELETE /api/cart/remove/{item_id}` - X√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè
- `DELETE /api/cart/clear` - X√≥a to√†n b·ªô gi·ªè h√†ng

### 3. API ƒê·∫∑t h√†ng
- `POST /api/orders/create` - T·∫°o ƒë∆°n h√†ng
- `GET /api/orders` - L·∫•y l·ªãch s·ª≠ ƒë∆°n h√†ng
- `GET /api/orders/{id}` - L·∫•y chi ti·∫øt ƒë∆°n h√†ng
- `POST /api/orders/{id}/payment` - X·ª≠ l√Ω thanh to√°n

### 4. API S·∫£n ph·∫©m ƒë√£ mua
- `GET /api/purchases/courses` - Kh√≥a h·ªçc ƒë√£ mua
- `GET /api/purchases/tests` - Tr·∫Øc nghi·ªám ƒë√£ mua
- `GET /api/purchases/consultations` - T∆∞ v·∫•n ƒë√£ ƒë·∫∑t
- `POST /api/tests/access/{token}` - Truy c·∫≠p tr·∫Øc nghi·ªám

### 5. API Admin Dashboard
- `GET /api/admin/dashboard/courses` - Qu·∫£n l√Ω kh√≥a h·ªçc ƒë√£ b√°n
- `GET /api/admin/dashboard/consultations` - Qu·∫£n l√Ω l·ªãch t∆∞ v·∫•n
- `POST /api/admin/consultations/{id}/schedule` - ƒê·∫∑t l·ªãch t∆∞ v·∫•n
- `GET /api/admin/sales-report` - B√°o c√°o doanh thu

## K·∫ø ho·∫°ch tri·ªÉn khai

### B∆∞·ªõc 1: Thi·∫øt l·∫≠p c∆° s·ªü d·ªØ li·ªáu
1. **T·∫°o c·∫•u tr√∫c database**
   - T·∫°o c√°c b·∫£ng SQL trong `sql/`
   - Script migration v√† seed data
   - C·∫≠p nh·∫≠t `config/db.php` n·∫øu c·∫ßn

### B∆∞·ªõc 2: Ph√°t tri·ªÉn API s·∫£n ph·∫©m
1. **API S·∫£n ph·∫©m c∆° b·∫£n**
   - `api/products/` folder structure
   - `list.php` - L·∫•y danh s√°ch s·∫£n ph·∫©m
   - `detail.php` - Chi ti·∫øt s·∫£n ph·∫©m
   - `admin-manage.php` - CRUD s·∫£n ph·∫©m cho admin

### B∆∞·ªõc 3: Ph√°t tri·ªÉn API gi·ªè h√†ng
1. **API Gi·ªè h√†ng**
   - `api/cart/` folder
   - `get.php`, `add.php`, `update.php`, `remove.php`, `clear.php`
   - Session ho·∫∑c database storage cho gi·ªè h√†ng

### B∆∞·ªõc 4: Ph√°t tri·ªÉn API ƒë·∫∑t h√†ng
1. **API ƒê·∫∑t h√†ng c∆° b·∫£n**
   - `api/orders/` folder
   - `create.php`, `list.php`, `detail.php`

2. **Logic x·ª≠ l√Ω sau mua h√†ng**
   - `api/orders/process-purchase.php`
   - T·∫°o m√£ kh√≥a h·ªçc, token tr·∫Øc nghi·ªám
   - Ghi nh·∫≠n v√†o c√°c b·∫£ng t∆∞∆°ng ·ª©ng

### B∆∞·ªõc 5: API qu·∫£n l√Ω s·∫£n ph·∫©m ƒë√£ mua
1. **API l·∫•y s·∫£n ph·∫©m ƒë√£ mua**
   - `api/purchases/` folder
   - `courses.php`, `tests.php`, `consultations.php`

### B∆∞·ªõc 6: Ph√°t tri·ªÉn giao di·ªán s·∫£n ph·∫©m
1. **Trang s·∫£n ph·∫©m**
   - `templates/products.html`
   - `templates/product-detail.html`
   - `components/product-card.html`
   - `assets/js/products.js`

### B∆∞·ªõc 7: Ph√°t tri·ªÉn giao di·ªán gi·ªè h√†ng
1. **Gi·ªè h√†ng**
   - `templates/cart.html`
   - `components/cart-item.html`
   - `assets/js/cart.js`
   - T√≠ch h·ª£p AJAX ƒë·ªÉ c·∫≠p nh·∫≠t gi·ªè h√†ng

### B∆∞·ªõc 8: Ph√°t tri·ªÉn giao di·ªán thanh to√°n ‚úÖ
1. **Trang thanh to√°n**
   - `templates/checkout.html` ‚úÖ
   - `templates/order-confirmation.html` ‚úÖ
   - `assets/js/checkout.js` ‚úÖ
   - `assets/js/order-confirmation.js` ‚úÖ
   - Form validation v√† UX t·ªëi ∆∞u ‚úÖ
   - T√≠ch h·ª£p payment gateway (s·∫Ω tri·ªÉn khai sau) üîÑ
   - T√≠ch h·ª£p payment gateway (n·∫øu c√≥)

### B∆∞·ªõc 9: Ph√°t tri·ªÉn giao di·ªán qu·∫£n l√Ω mua h√†ng
1. **Trang qu·∫£n l√Ω mua h√†ng**
   - `templates/my-purchases.html`
   - `templates/my-courses.html`
   - `templates/my-tests.html`
   - `templates/my-consultations.html`
   - `assets/js/purchases.js`

### B∆∞·ªõc 10: Ph√°t tri·ªÉn h·ªá th·ªëng tr·∫Øc nghi·ªám
1. **H·ªá th·ªëng tr·∫Øc nghi·ªám**
   - `templates/test.html`
   - `api/tests/` folder
   - `access.php`, `submit.php`, `results.php`
   - `assets/js/test.js`
   - X√°c th·ª±c token v√† quy·ªÅn truy c·∫≠p

### B∆∞·ªõc 11: Ph√°t tri·ªÉn dashboard admin cho kh√≥a h·ªçc
1. **Dashboard admin cho kh√≥a h·ªçc**
   - `templates/admin/course-purchases.html`
   - `api/admin/dashboard/` folder
   - `courses.php` - Qu·∫£n l√Ω l·ªãch s·ª≠ mua kh√≥a h·ªçc
   - T√≠nh nƒÉng t√¨m ki·∫øm, filter, export

### B∆∞·ªõc 12: Ph√°t tri·ªÉn dashboard admin cho t∆∞ v·∫•n
1. **Dashboard admin cho t∆∞ v·∫•n**
   - `templates/admin/consultation-bookings.html`
   - `consultations.php` - Qu·∫£n l√Ω l·ªãch t∆∞ v·∫•n
   - T√≠nh nƒÉng ƒë·∫∑t l·ªãch, ph√¢n c√¥ng chuy√™n gia
   - Notification system

### B∆∞·ªõc 13: Testing v√† ki·ªÉm th·ª≠
1. **Testing to√†n di·ªán**
   - Test t·∫•t c·∫£ lu·ªìng mua h√†ng
   - Test security (SQL injection, XSS)
   - Test performance v·ªõi d·ªØ li·ªáu l·ªõn

### B∆∞·ªõc 14: C·∫£i thi·ªán UI/UX
1. **UI/UX c·∫£i thi·ªán**
   - Responsive design
   - Loading states
   - Error handling
   - Toast notifications

### B∆∞·ªõc 15: Tri·ªÉn khai v√† t√†i li·ªáu
1. **Deployment v√† documentation**
   - C·∫≠p nh·∫≠t deployment guide
   - T·∫°o user manual
   - Admin manual
   - API documentation

## C·∫•u tr√∫c th∆∞ m·ª•c m·ªõi

```
api/
‚îú‚îÄ‚îÄ products/
‚îÇ   ‚îú‚îÄ‚îÄ list.php
‚îÇ   ‚îú‚îÄ‚îÄ detail.php
‚îÇ   ‚îî‚îÄ‚îÄ admin-manage.php
‚îú‚îÄ‚îÄ cart/
‚îÇ   ‚îú‚îÄ‚îÄ get.php
‚îÇ   ‚îú‚îÄ‚îÄ add.php
‚îÇ   ‚îú‚îÄ‚îÄ update.php
‚îÇ   ‚îú‚îÄ‚îÄ remove.php
‚îÇ   ‚îî‚îÄ‚îÄ clear.php
‚îú‚îÄ‚îÄ orders/
‚îÇ   ‚îú‚îÄ‚îÄ create.php
‚îÇ   ‚îú‚îÄ‚îÄ list.php
‚îÇ   ‚îú‚îÄ‚îÄ detail.php
‚îÇ   ‚îî‚îÄ‚îÄ process-purchase.php
‚îú‚îÄ‚îÄ purchases/
‚îÇ   ‚îú‚îÄ‚îÄ courses.php
‚îÇ   ‚îú‚îÄ‚îÄ tests.php
‚îÇ   ‚îî‚îÄ‚îÄ consultations.php
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ access.php
‚îÇ   ‚îú‚îÄ‚îÄ submit.php
‚îÇ   ‚îî‚îÄ‚îÄ results.php
‚îî‚îÄ‚îÄ admin/
    ‚îî‚îÄ‚îÄ dashboard/
        ‚îú‚îÄ‚îÄ courses.php
        ‚îú‚îÄ‚îÄ consultations.php
        ‚îî‚îÄ‚îÄ sales-report.php

templates/
‚îú‚îÄ‚îÄ products.html
‚îú‚îÄ‚îÄ product-detail.html
‚îú‚îÄ‚îÄ cart.html
‚îú‚îÄ‚îÄ checkout.html
‚îú‚îÄ‚îÄ order-confirmation.html
‚îú‚îÄ‚îÄ my-purchases.html
‚îú‚îÄ‚îÄ my-courses.html
‚îú‚îÄ‚îÄ my-tests.html
‚îú‚îÄ‚îÄ my-consultations.html
‚îú‚îÄ‚îÄ test.html
‚îî‚îÄ‚îÄ admin/
    ‚îú‚îÄ‚îÄ course-purchases.html
    ‚îú‚îÄ‚îÄ consultation-bookings.html
    ‚îî‚îÄ‚îÄ product-management.html

components/
‚îú‚îÄ‚îÄ product-card.html
‚îú‚îÄ‚îÄ cart-item.html
‚îú‚îÄ‚îÄ cart-summary.html
‚îú‚îÄ‚îÄ purchase-item.html
‚îî‚îÄ‚îÄ admin/
    ‚îú‚îÄ‚îÄ purchase-table.html
    ‚îî‚îÄ‚îÄ consultation-table.html

assets/js/
‚îú‚îÄ‚îÄ products.js
‚îú‚îÄ‚îÄ cart.js
‚îú‚îÄ‚îÄ checkout.js
‚îú‚îÄ‚îÄ purchases.js
‚îú‚îÄ‚îÄ test.js
‚îî‚îÄ‚îÄ admin/
    ‚îú‚îÄ‚îÄ product-management.js
    ‚îú‚îÄ‚îÄ course-dashboard.js
    ‚îî‚îÄ‚îÄ consultation-dashboard.js

sql/
‚îú‚îÄ‚îÄ create-products-table.sql
‚îú‚îÄ‚îÄ create-cart-table.sql
‚îú‚îÄ‚îÄ create-orders-tables.sql
‚îú‚îÄ‚îÄ create-purchases-tables.sql
‚îú‚îÄ‚îÄ create-consultation-tables.sql
‚îú‚îÄ‚îÄ create-experts-table.sql
‚îî‚îÄ‚îÄ seed-sample-products.sql
```

## T√≠nh nƒÉng b·∫£o m·∫≠t

1. **X√°c th·ª±c token tr·∫Øc nghi·ªám**
   - Token c√≥ th·ªùi h·∫°n
   - Ch·ªâ s·ª≠ d·ª•ng ƒë∆∞·ª£c m·ªôt l·∫ßn
   - Li√™n k·∫øt v·ªõi user v√† ƒë∆°n h√†ng c·ª• th·ªÉ

2. **B·∫£o v·ªá API**
   - Session validation
   - Rate limiting
   - Input sanitization
   - SQL injection prevention

3. **Quy·ªÅn truy c·∫≠p**
   - User ch·ªâ th·∫•y s·∫£n ph·∫©m ƒë√£ mua c·ªßa m√¨nh
   - Admin c√≥ full access
   - Staff c√≥ quy·ªÅn h·∫°n ch·∫ø

## T√≠ch h·ª£p payment

- H·ªó tr·ª£ multiple payment methods
- Webhook ƒë·ªÉ x·ª≠ l√Ω payment callback
- Payment status tracking
- Refund handling (n·∫øu c·∫ßn)

## Monitoring v√† Analytics

- Tracking mua h√†ng
- Conversion rate
- Popular products
- Revenue reports
- User behavior analytics

---

**L∆∞u √Ω**: K·∫ø ho·∫°ch n√†y c√≥ th·ªÉ ƒëi·ªÅu ch·ªânh t√πy theo complexity v√† y√™u c·∫ßu c·ª• th·ªÉ. ∆Øu ti√™n tri·ªÉn khai theo t·ª´ng phase ƒë·ªÉ ƒë·∫£m b·∫£o ch·∫•t l∆∞·ª£ng v√† c√≥ th·ªÉ test t·ª´ng t√≠nh nƒÉng m·ªôt c√°ch ƒë·ªôc l·∫≠p.
